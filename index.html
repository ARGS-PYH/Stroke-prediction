<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stroke Risk Prediction System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-primary mb-4">
  <div class="container-fluid">
    <span class="navbar-brand mb-0 h1">Explainable Stroke Risk Prediction</span>
  </div>
</nav>

<div class="container">
    <div class="card shadow-lg rounded-4">
        <div class="card-body p-4">
            <h4 class="card-title mb-3">Patient Information</h4>
            <form id="strokeForm">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Age</label>
                        <input type="number" class="form-control" required />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Gender</label>
                        <select class="form-select">
                            <option>Male</option>
                            <option>Female</option>
                        </select>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Hypertension</label>
                        <select class="form-select">
                            <option>No</option>
                            <option>Yes</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Heart Disease</label>
                        <select class="form-select">
                            <option>No</option>
                            <option>Yes</option>
                        </select>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Average Glucose Level</label>
                        <input type="number" class="form-control" />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">BMI</label>
                        <input type="number" class="form-control" />
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Smoking Status</label>
                    <select class="form-select">
                        <option>Never smoked</option>
                        <option>Formerly smoked</option>
                        <option>Smokes</option>
                        <option>Unknown</option>
                    </select>
                </div>

                <button type="submit" class="btn btn-primary w-100 mt-3">Predict Stroke Risk</button>
            </form>
        </div>
    </div>

    <div class="card mt-4 shadow-sm rounded-4">
        <div class="card-body">
            <h5>Prediction Result</h5>
            <p><strong>Stroke Risk:</strong> <span id="riskScore" class="text-danger">--%</span></p>
            <p><strong>Risk Level:</strong> <span id="riskLevel">--</span></p>
            <hr>
            <h6>Explainable AI Insight</h6>
            <p id="explanation" class="text-muted">
                Feature-level explanations (SHAP/LIME) will appear here to show why the model made this prediction.
            </p>
        </div>
    </div>
</div>

<footer class="text-center text-muted mt-5 mb-3">
    <small>Final Year Project â€“ B.Sc Computer Science | Explainable AI for Stroke Prediction</small>
</footer>

<script>

document.getElementById('strokeForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const inputs = document.querySelectorAll('input[type="number"]');
    const selects = document.querySelectorAll('select');

    const payload = {
        age: parseInt(inputs[0].value),
        hypertension: selects[1].value === 'Yes' ? 1 : 0,
        heart_disease: selects[2].value === 'Yes' ? 1 : 0,
        avg_glucose_level: parseFloat(inputs[1].value),
        bmi: parseFloat(inputs[2].value)
    };

    try {
        const response = await fetch('http://127.0.0.1:8000/predict', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        if (!response.ok) throw new Error('Network response was not ok');

        const result = await response.json();

        document.getElementById('riskScore').innerText = (result.risk_score * 100).toFixed(2) + '%';
        document.getElementById('riskLevel').innerText = result.risk_level;
        document.getElementById('explanation').innerText = result.explanation;

    } catch (error) {
        alert('Backend not reachable. Make sure the FastAPI server is running and accessible.');
    }
});
</script>

</body>
</html>